<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Living Soil Calculator - Grow With Les v1.5</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f4f1ed;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            background: #dfe6e9;
            padding: 10px 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        label, select, input {
            display: block;
            margin-bottom: 10px;
        }
        input[type="text"], input[type="number"], input[type="date"], select {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        button {
            background-color: #2e7d32;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            transition: background-color 0.2s ease;
            margin-right: 10px;
        }
        button:hover {
            background-color: #1b5e20;
        }
        .output {
            margin-top: 20px;
            background: #ffffff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .footer {
            margin-top: 40px;
            font-size: 0.9em;
            color: gray;
            text-align: center;
        }
        .timer {
            background: #ffeeba;
            border: 1px solid #f0ad4e;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-weight: bold;
        }
        .planty-tip {
            margin-top: 20px;
            background-color: #e0f7fa;
            border-left: 5px solid #00acc1;
            padding: 15px;
            border-radius: 10px;
            font-style: italic;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
    </style>
</head>

    <div style="text-align: center; margin-bottom: 20px;">
        <img src="GetAttachmentThumbnail.jpg" alt="Grow With Les" style="max-width: 50%; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);">
    </div>
    <h1>Living Soil Calculator ‚Äì Grow With Les</h1>

    <label for="strain">Strain Name:</label>
    <input type="text" id="strain" placeholder="e.g., Blueberry OG">

    <label for="plantType">What Type of Plant?</label>
    <select id="plantType">
        <option value="" disabled selected>Select an option</option>
        <option>Photoperiod ‚Äì Indica-Dominant</option>
        <option>Photoperiod ‚Äì Sativa-Dominant</option>
        <option>Autoflower ‚Äì Indica-Dominant</option>
        <option>Autoflower ‚Äì Sativa-Dominant</option>
        <option>Hybrid (Photo or Auto)</option>
        <option>Custom / Unknown</option>
    </select>

    <label for="feeding">How Hungry is Your Plant? (Feeding Intensity)</label>
    <select id="feeding">
        <option value="" disabled selected>Select an option</option>
        <option>Heavy Feeder üêò</option>
        <option>Moderate Feeder üêï</option>
        <option>Light Feeder üêá</option>
        <option>I don‚Äôt know yet ü§∑‚Äç‚ôÇÔ∏è</option>
    </select>

    <label for="soil">Choose Your Soil Base:</label>
    <select id="soil">
        <option value="" disabled selected>Select an option</option>
        <option>FoxFarm Ocean Forest</option>
        <option>Happy Frog</option>
        <option>BuildASoil 3.0</option>
        <option>Mother Earth Terracraft</option>
        <option>Coast of Maine Stonington Blend</option>
        <option>Custom Mix (User-defined)</option>
    </select>

    <label for="gallons">How Many Gallons of Soil Do You Need?</label>
    <input type="number" id="gallons" min="1" placeholder="e.g., 10">

    <label><input type="checkbox" id="unitToggle"> Show recipe in % by volume instead of Cups/Gallons</label>
    <label><input type="checkbox" id="includeAlfalfa"> Include Alfalfa Meal</label>

    <label for="cookStart">When did you start cooking your soil?</label>
    <input type="date" id="cookStart">

    <button onclick="calculateMix()">Calculate My Soil Mix</button>
    <button onclick="resetForm()">Reset</button>

    <div class="output" id="output" aria-live="polite">
        <h2>Your Soil Recipe Will Appear Here</h2>
        <p>Fill out the form and click the button to calculate your mix.</p>
    </div>

    <div class="planty-tip" id="plantyTip"></div>

    <div class="footer">
        Version: v1.5 ‚Äì Now featuring Planty's Tips & a softer new look.
    </div>

    <script>
    function calculateMix() {
        const missingFields = []; // Ensure this is reset before adding new fields
        const strain = document.getElementById('strain').value;
        const plantType = document.getElementById('plantType').value;
        const feeding = document.getElementById('feeding').value;
        const soil = document.getElementById('soil').value;
        const gallonsInput = document.getElementById('gallons');
        const gallons = parseFloat(gallonsInput.value);
        const percentMode = document.getElementById('unitToggle').checked;
        const includeAlfalfa = document.getElementById('includeAlfalfa').checked;
        const cookStart = document.getElementById('cookStart').value;

        const tip = document.getElementById('plantyTip');

        // Validate required fields
        if (!strain || !plantType || !feeding || !soil) {
            if (!strain) missingFields.push(document.getElementById('strain'));
            if (!plantType) missingFields.push(document.getElementById('plantType'));
            if (!feeding) missingFields.push(document.getElementById('feeding'));
            if (!soil) missingFields.push(document.getElementById('soil'));

            missingFields.forEach(field => {
                field.style.border = '2px solid red';
            });

            let plantyMessage = "üå± Planty says: Let's get those blanks filled in before we mix!";
            if (!strain) plantyMessage = "üå± Planty says: What strain are we growing? Gotta name your baby!";
            else if (!plantType) plantyMessage = "üå± Planty says: Pick your plant type so I know how it grows.";
            else if (!feeding) plantyMessage = "üå± Planty says: Tell me how hungry your plant is ‚Äî I won‚Äôt judge!";
            else if (!soil) plantyMessage = "üå± Planty says: What soil are we starting with? I need the dirt on your dirt!";
            tip.innerHTML = plantyMessage;
            document.getElementById('output').innerHTML = `<p style='color:red;'>Please fill in all required fields.</p>`;
            missingFields[0].scrollIntoView({ behavior: 'smooth' });
            return;
        } else {
            document.getElementById('strain').style.border = '';
            document.getElementById('plantType').style.border = '';
            document.getElementById('feeding').style.border = '';
            document.getElementById('soil').style.border = '';
        }

        // Validate gallons input
        if (isNaN(gallons) || gallons <= 0) {
            gallonsInput.style.border = '2px solid red';
            tip.innerHTML = "üå± Planty says: Please enter a valid positive number of gallons.";
            return;
        } else {
            gallonsInput.style.border = ''; // Reset border on valid input
        }

        // Validate cookStart date
        if (cookStart) {
            const now = new Date();
            const startDate = new Date(cookStart);

            if (startDate > now) {
                document.getElementById('cookStart').style.border = '2px solid red';
                tip.innerHTML = "üå± Planty says: The start date cannot be in the future. Please enter a valid date.";
                return;
            } else {
                document.getElementById('cookStart').style.border = ''; // Reset border on valid input
            }
        }

        // Generate Planty Tip
        tip.innerHTML = `${getPlantyTip(plantType, feeding)}<br>${getRandomTip()}`;

        // Calculate Soil Mix
        let feedMultiplier = 1;
        if (feeding.includes("Light")) feedMultiplier = 0.75;
        else if (feeding.includes("Heavy")) feedMultiplier = 1.25;
        if (plantType.includes("Auto")) feedMultiplier *= 0.85;

        let outputText = `<h2>Soil Mix for ${strain || 'Generic Strain'}</h2>`;
        outputText += `<p><strong>Plant Type:</strong> ${plantType}</p>`;
        outputText += `<p><strong>Feeding Intensity:</strong> ${feeding}</p>`;
        outputText += `<p><strong>Soil Base:</strong> ${soil}</p>`;
        outputText += `<p><strong>Gallons:</strong> ${gallons}</p>`;

        if (percentMode) {
            outputText += `
                <ul>
                    <li>50% Soil Base</li>
                    <li>25% Compost (Worm Castings + Mushroom Compost)</li>
                    <li>25% Amendments (see breakdown below)</li>
                </ul>
            `;
        } else {
            outputText += `
                <ul>
                    <li>${(gallons * 0.5).toFixed(1)} gal Soil Base</li>
                    <li>${(gallons * 0.25).toFixed(1)} gal Compost</li>
                </ul>
                <h3>Amendment Breakdown</h3>
                <ul>
                    <li>${(gallons * 0.05 * feedMultiplier).toFixed(1)} cups Blood Meal</li>
                    <li>${(gallons * 0.05 * feedMultiplier).toFixed(1)} cups Bone Meal</li>
                    <li>${(gallons * 0.075 * feedMultiplier).toFixed(1)} cups Dr. Earth 4-6-3</li>
                    <li>${(gallons * 0.0375 * feedMultiplier).toFixed(1)} cups Basalt Rock Dust</li>
                    <li>${(gallons * 0.025 * feedMultiplier).toFixed(1)} cups Gypsum</li>
                    ${includeAlfalfa ? `<li>${(gallons * 0.025 * feedMultiplier).toFixed(1)} cups Alfalfa Meal (optional)</li>` : ''}
                </ul>
            `;
        }

        // Add soil cooking message if applicable
        if (cookStart) {
            const now = new Date();
            const startDate = new Date(cookStart);
            const cookDays = Math.floor((now - startDate) / (1000 * 60 * 60 * 24));
            const daysLeft = Math.max(0, 28 - cookDays);
            outputText += `
                <div class="timer">
                    <strong>Soil Cooking Status:</strong><br>
                    ${cookDays} days since mixing.<br>
                    ${daysLeft > 0 ? `${daysLeft} days left to finish cooking.` : `‚úÖ Soil has cooked for 4+ weeks.`}<br>
                    Turn your soil once per week to keep it active.
                </div>
            `;
        } else {
            outputText += `
                <div class="timer">
                    ‚ö†Ô∏è Let this soil mix cook for <strong>4 weeks</strong> before planting.<br>
                    Turn the mix once per week to promote microbial activity.
                </div>
            `;
        }

        document.getElementById('output').innerHTML = outputText;
    }

    function getPlantyTip(plantType, feeding) {
        if (plantType.includes("Auto")) {
            return "üå± Planty says: Autos are sensitive! We‚Äôve toned down the amendment strength just for them.";
        }
        if (feeding.includes("Heavy")) {
            return "üå± Planty says: You picked a heavy feeder ‚Äî don‚Äôt skimp on compost and microbial life.";
        }
        if (feeding.includes("Light")) {
            return "üå± Planty says: Light feeders thrive in balanced soil ‚Äî keep it mellow, don‚Äôt go overboard.";
        }
        return "üå± Planty says: Balanced feeding and rich soil lead to happy roots. Let‚Äôs mix it right!";
    }

    function getRandomTip() {
        const tips = [
            "üå± Worm castings are a great source of nutrients for your plants!",
            "üå± Turn your soil weekly to keep it active and aerated.",
            "üå± Adding mycorrhizal fungi can supercharge your plant's root system.",
            "üå± Overwatering is one of the most common mistakes in gardening.",
            "üå± Healthy soil = healthy plants. Focus on building microbial life in your mix.",
            "üå± Compost tea can give your plants a quick nutrient boost!",
            "üå± Mulching helps retain moisture and suppress weeds in your garden.",
            "üå± Always let your soil cook for at least 4 weeks for the best results.",
            "üå± Adding biochar can improve soil structure and nutrient retention.",
            "üå± Keep an eye on pH levels to ensure your plants can absorb nutrients effectively."
        ];
        const randomIndex = Math.floor(Math.random() * tips.length);
        return tips[randomIndex];
    }
</script>
</body>
</html>
